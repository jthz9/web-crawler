# 재생에너지 컨설팅 AI 에이전트

## 전체 프로젝트 구조

### 📊 시스템 아키텍처

## 아키텍쳐 레이어

### 1. AI 에이전트 계층 (오케스트레이터)

┌─────────────────────────────────────┐
│ • 사용자 의도 분석 │
│ • 요청 분류 및 라우팅 │
│ • 결과 통합 및 응답 생성 │
│ • 대화 컨텍스트 관리 │
└─────────────────────────────────────┘

### 2. 처리 엔진 계층

┌─────────────────┐ ┌─────────────────┐
│ ML 예측 엔진 │ │ RAG 챗봇 │
├─────────────────┤ ├─────────────────┤
│ • 발전량 예측 │ │ • 정책 정보 │
│ • 경제성 분석 │ │ • 기술 가이드 │
│ • 투자 수익률 │ │ • FAQ 답변 │
│ • 최적 입지 선정 │ │ • 절차 안내 │
│ • 설비 용량 최적화 │ │ • 사례 기반 조언 │
└─────────────────┘ └─────────────────┘

### 3. 데이터 소스 계층

┌─────────────────┐ ┌─────────────────┐
│ 기상/지리 데이터 │ │ 웹 크롤링 시스템 │
├─────────────────┤ ├─────────────────┤
│ • 기상청 API │ │ • Scrapy │
│ • 일사량 데이터 │ │ • 정책 문서 │
│ • 풍속/풍향 정보 │ │ • 기술 가이드 │
│ • 지형 고도 정보 │ │ • 법규 정보 │
└─────────────────┘ └─────────────────┘

---

## 워크플로우

### ML 예측 파이프라인

```
기상 데이터 수집 → 전처리 → ML 모델 입력 → 발전량 예측 → 경제성 분석 → 결과 제공
     ↓              ↓          ↓            ↓            ↓
  실시간 API     정규화/변환   학습된 모델    수치 결과    투자 분석
```

### RAG 챗봇 파이프라인

```
웹 크롤링 → 텍스트 전처리 → 임베딩 생성 → 벡터DB 저장 → 유사도 검색 → 답변 생성
    ↓           ↓            ↓           ↓            ↓           ↓
 원본 데이터   텍스트 정제    벡터 변환    인덱싱      관련 문서     LLM 응답
```

---

## 🛠️ 기술 스택

### 웹 크롤링

- **Scrapy**: 고성능 크롤링 프레임워크
- **Selenium**: JavaScript 처리용 브라우저 자동화
- **BeautifulSoup**: HTML 파싱
- **Requests**: HTTP 클라이언트

### ML/AI

- **scikit-learn**: 머신러닝 모델
- **PyTorch**: 딥러닝 모델
- **LangChain**: AI 에이전트 프레임워크
- **OpenAI API**: LLM 서비스

### RAG 시스템

- **Sentence Transformers**: 임베딩 생성
- **Pinecone/ChromaDB**: 벡터 데이터베이스
- **FAISS**: 유사도 검색
- **Hugging Face**: 사전 훈련된 모델

### 백엔드

- **FastAPI**: REST API 서버
- **PostgreSQL**: 관계형 데이터베이스
- **Redis**: 캐싱 및 세션 관리
- **Celery**: 비동기 작업 처리

### 프론트엔드 (선택사항)

- **React**: 사용자 인터페이스
- **Next.js**: 풀스택 프레임워크
- **Streamlit**: 빠른 프로토타이핑

---

## 📋 구현 단계

### Phase 1: RAG 시스템 구축 - 진행중

#### ✅ 완료된 작업

- [x] **웹 크롤링 시스템** - Scrapy-Selenium 파이프라인 구축
  - ✅ BaseFAQSpider 재사용 가능한 구조 설계
  - ✅ KnrecFaqSpider KNREC 전용 스파이더 구현
  - ✅ AnalysisService 중앙 분석 결과 관리
  - ✅ RenewableEnergyPipeline 데이터 처리 파이프라인
- [x] **데이터 수집** - KNREC FAQ 크롤링 완료
  - ✅ 149KB, 202줄의 구조화된 FAQ 데이터 수집
  - ✅ 주요 카테고리: 주택/건물지원, 금융지원, RPS제도, 인증/검증

##### 1단계: 데이터 전처리 및 분석 (완료)

- [x] **크롤링 데이터 분석**
  - ✅ FAQ 데이터 구조 상세 분석
  - ✅ 카테고리별 분류 (주택지원, 건물지원, 금융지원, RPS, 인증 등)
  - ✅ 중복 제거 및 데이터 품질 검증
  - ✅ 텍스트 전처리 (한국어 토큰화, 정규화)

##### 2단계: 임베딩 및 벡터 데이터베이스 구축 (진행중)

- [x] **임베딩 모델 선택**
  - ✅ 한국어 sentence-transformers 모델 평가
  - ✅ multilingual vs 한국어 특화 모델 성능 비교
  - ✅ 최종 모델: jhgan/ko-sroberta-multitask 선정
- [ ] **벡터 데이터베이스 구축**
  - ✅ ChromaDB 도커 환경 구성
  - ✅ 기본 인덱싱 및 연결 구현
  - ⚠️ 메타데이터 필터링 구조 고도화 필요
  - ⚠️ 배치 처리 및 업데이트 전략 수립 필요
- [ ] **검색 시스템 구현**
  - ✅ 기본 유사도 검색 구현
  - ⚠️ 하이브리드 검색 (키워드 + 시맨틱) 구현 필요
  - ⚠️ 결과 랭킹 및 필터링 고도화 필요

##### 3단계: 기본 RAG 파이프라인 구축 (예정)

- [ ] **LLM 통합**
  - [ ] OpenAI API 연동
  - [ ] 프롬프트 엔지니어링 (한국어 최적화)
  - [ ] 컨텍스트 윈도우 관리
- [ ] **답변 생성**
  - [ ] RAG 파이프라인 구현
  - [ ] 출처 표시 및 신뢰도 점수
  - [ ] 답변 품질 검증

##### 4단계: 성능 평가 및 최적화 (예정)

- [ ] **테스트 데이터 준비**
  - [ ] 재생에너지 관련 질문 세트 구성
  - [ ] Ground truth 답변 준비
- [ ] **성능 평가**
  - [ ] 검색 정확도 (Precision, Recall)
  - [ ] 답변 품질 (ROUGE, BLEU 등)
  - [ ] 응답 시간 측정
- [ ] **최적화**
  - [ ] 하이퍼파라미터 튜닝
  - [ ] 프롬프트 최적화
  - [ ] 임베딩 모델 파인튜닝 고려

##### 5단계: 기본 CLI 인터페이스 (예정)

- [ ] **명령행 인터페이스**
  - [ ] 질문 입력 → 답변 출력
  - [ ] 검색된 관련 문서 표시
  - [ ] 신뢰도 점수 및 출처 정보
  - [ ] 대화 히스토리 저장

#### 📅 다음 우선순위

1. **즉시 진행**: 2단계 마무리
   - 메타데이터 필터링 구조 고도화
   - 하이브리드 검색 구현
   - 결과 랭킹 및 필터링 고도화
2. **다음 단계**: 3단계 RAG 파이프라인 구현
   - LLM 통합
   - 답변 생성
   - 품질 검증

### Phase 2: ML 엔진

- [ ] **데이터 수집** - 기상청, 지리 데이터 API 연동
- [ ] **예측 모델** - 태양광/풍력 발전량 예측
- [ ] **경제성 분석** - ROI, NPV 계산 엔진
- [ ] **최적화 알고리즘** - 입지/용량 최적화

### Phase 3: AI 에이전트

- [ ] **에이전트 프레임워크** - LangChain 기반 구현
- [ ] **의도 분류** - ML vs RAG 라우팅
- [ ] **결과 통합** - 정량+정성 분석 결합
- [ ] **대화 관리** - 컨텍스트 유지

### Phase 4: 사용자 인터페이스 개발

- [ ] **API 서버** - FastAPI 백엔드
- [ ] **사용자 인터페이스** - 웹/모바일 앱
- [ ] **성능 최적화** - 응답 속도 개선
- [ ] **배포 및 운영** - 클라우드 배포
